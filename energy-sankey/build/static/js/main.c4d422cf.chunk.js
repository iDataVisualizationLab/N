(this["webpackJsonpenergy-sankey"]=this["webpackJsonpenergy-sankey"]||[]).push([[0],{285:function(e,t,n){},286:function(e,t,n){},296:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),r=n(16),a=n.n(r),s=(n(285),n(5)),c=(n.p,n(286),n(64)),l=n(35),u=n(36),h=n(39),d=n(41),g=n(18),f=n(299),v=n(102),p=n(174),m=n(178),b=n(33),j=n(11),O=Object(b.a)((function(e){return{freezing:{"&:not(.highlight)":{pointerEvents:"none"}},notFreezing:{"&:not(.highlight)":{pointerEvents:"auto"}}}})),k=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"onHandleClick",value:function(){var e=!this.props.freezing;this.props.setfreezing(e)}},{key:"onMouseOver",value:function(){this.props.freezing||this.props.mouseOver()}},{key:"onMouseLeave",value:function(){this.props.freezing||this.props.mouseLeave()}},{key:"render",value:function(){var e=this,t=this.props,n=(t.children,t.className),i=(t.setfreezing,t.mouseLeave,t.mouseOver,Object(m.a)(t,["children","className","setfreezing","mouseLeave","mouseOver"])),o=this.props.freezing;return Object(j.jsx)("g",Object(c.a)(Object(c.a)({},i),{},{onClick:function(){return e.onHandleClick()},className:[n,o?O.freezing:O.notFreezing].join(" "),onMouseOver:!o&&this.onMouseOver.bind(this),onMouseLeave:!o&&this.onMouseLeave.bind(this),children:this.props.children}))}}]),n}(o.a.Component),y=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var i;return Object(l.a)(this,n),(i=t.call(this,e)).svgRef=o.a.createRef(),i.padding=0,i.isAnimate=!1,i.sankey=Object(v.a)().nodeWidth(.1).nodeAlign((function(e){return e.layer})).nodePadding(5),i.y=g.f(),i.x=g.g(),i.svg=g.j(null),i.g=g.j(null),i.color=g.e(g.h),i._color=g.e(g.h),i.zoomFunc=g.m().on("zoom",(function(e){i.svg.select("g.content").attr("transform",e.transform)})),i.getColorScale=i._getColorScale_byName,i.state={freezing:!1,margin:{top:20,right:20,bottom:30,left:100},data:[],times:[],nodes:[],links:[],graph:{}},i}return Object(u.a)(n,[{key:"widthView",value:function(){var e;return this.props.width*(null!==(e=this.state.scalezoom)&&void 0!==e?e:1)}},{key:"heightView",value:function(){var e;return this.props.height*(null!==(e=this.state.scalezoom)&&void 0!==e?e:1)}},{key:"widthG",value:function(){var e,t;return this.widthView()-(null!==(e=this.state.margin)&&void 0!==e?e:{top:0,bottom:0,left:0,right:0}).left-(null!==(t=this.state.margin)&&void 0!==t?t:{top:0,bottom:0,left:0,right:0}).right}},{key:"heightG",value:function(){var e,t;return this.heightView()-(null!==(e=this.state.margin)&&void 0!==e?e:{top:0,bottom:0,left:0,right:0}).top-(null!==(t=this.state.margin)&&void 0!==t?t:{top:0,bottom:0,left:0,right:0}).bottom}},{key:"componentDidMount",value:function(){var e=this.state.margin;this.svg=g.j(this.svgRef.current),this.g=this.svg.select("g.content"),this.svg.call(this.zoomFunc.bind(this)).call(this.zoomFunc.transform,g.n.translate(e.left,e.top)),this.draw()}},{key:"componentDidUpdate",value:function(e,t,n){if(this.props.nodes!==e.nodes||this.props.links!==e.links)this.draw();else if(this.props.width!==e.width||this.props.height!==e.height){var i=this.state.graph,o=i.nodes,r=i.links,a=i.N;this.renderSankey({nodes:o,links:r,N:a})}else if(this.state.isForceDone!==t.isForceDone&&this.state.isForceDone&&!this.svg.empty()){var s=this.state.margin;this.svg.call(this.zoomFunc.transform,g.n.translate(s.left,s.top))}}},{key:"freezeHandle",value:function(){this.state.freezing&&this.setState({freezing:!1})}},{key:"draw",value:function(){var e=this.state.freezing,t=this.props,n=t.linkSource,i=t.linkTarget,o=t.linkValue,r=t.nodeId,a=t.nodeGroup,s=this.props,c=s.nodes,l=s.links,u=s.linkColor,h=s.nodeGroups;e&&this.freezeHandle();var d=Object(p.a)(l,n).map(C),f=Object(p.a)(l,i).map(C),v=Object(p.a)(l,o);void 0===c&&(c=Array.from(g.l(d,f),(function(e){return{id:e}})));var m=Object(p.a)(c,r).map(C),b=null==a?null:Object(p.a)(c,a).map(C),j=Object(p.a)(c,(function(e,t){return{id:m[t],element:e.element,layer:e.layer}})),O=Object(p.a)(l,(function(e,t){return{source:d[t],target:f[t],_id:"link_"+JSON.stringify([d[t],f[t]]).replace(/\.|\[|\]| |"|\\|:|-|,/g,""),value:v[t],element:e.element}}));!b&&["source","target","source-target"].includes(u)&&(u="currentColor"),b&&void 0===h&&(h=b),this.renderSankey({nodes:j,links:O,N:m})}},{key:"renderSankey",value:function(e){var t=e.nodes,n=e.links,i=e.N,o=this.props,r=o.nodeAlign,a=o.nodeWidth,s=o.nodePadding,c=o.nodeTitle,l=o.linkTitle,u=this.props,h=u.format,d=u.nodeLabel,f=this.widthG(),m=this.heightG();t.length&&n.length&&Object(v.a)().nodeId((function(e){var t=e.index;return i[t]})).nodeAlign(r).nodeWidth(a).nodePadding(s).extent([[0,0],[f,m]])({nodes:t,links:n}),"function"!==typeof h&&(h=g.b(h));var b=void 0===d?i:null==d?null:Object(p.a)(t,d),j=null==c?null:Object(p.a)(t,(function(e){return c(h,e)})),O=null==l?null:Object(p.a)(n,(function(e){return l(h,e)}));this.setState({nodes:t,links:n,N:i,Tl:b,Tt:j,Lt:O,format:h,isForceDone:!0})}},{key:"onMouseOver",value:function(e,t){var n={list:{},el:e,event:t};n.list[e.source.id]=!0,this.setState({highlight:n}),this.props.mouseOver&&this.props.mouseOver(e)}},{key:"onRelease",value:function(){this.setState({highlight:void 0,highlightJob:void 0}),this.props.mouseLeave&&this.props.mouseLeave()}},{key:"_getColorScale_byName",value:function(e){return this._color(e.id)}},{key:"_getColorScale_byValue",value:function(e){var t=this.getValue(e);return""+this.color(t)}},{key:"getValue",value:function(e){var t,n=+(null!==(t=this.props.colorBy)&&void 0!==t?t:"0");return e.value[n]}},{key:"render",value:function(){var e,t,n=this,i=this.props,o=i.width,r=i.height,a=i.linkColor,s=i.linkPath,c=(i.theme,i.classes),l=this.state,u=(l.margin,l.nodes),h=l.links,d=l.isForceDone,f=l.highlight,v=this.x;return this.y.range([0,this.heightG()]).padding(this.padding),v.range([0,this.widthG()]),this._color=null!==(e=this.props.colorByName)&&void 0!==e?e:g.e(["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"]),this.color=null!==(t=this.props.color)&&void 0!==t?t:this._color,this.props.color&&("name"===this.props.colorBy?this.getColorScale=this._getColorScale_byName:this.getColorScale=this._getColorScale_byValue),Object(j.jsx)("div",{style:{width:o+" px",height:r+" px",position:"relative"},children:Object(j.jsxs)("svg",{width:o,height:r,viewBox:"0 0 ".concat(o," ").concat(r),ref:this.svgRef,className:c.svg,children:[Object(j.jsx)("defs",{}),Object(j.jsx)("rect",{className:"pantarget",width:o,height:r,onClick:function(){return n.freezeHandle()},opacity:"0"}),this.state.freezing&&Object(j.jsx)("text",{fill:"black",transform:"translate(".concat(this.widthG()/2,",20)"),children:"Click anywhere to release"}),d?Object(j.jsxs)("g",{className:"content"+(f?" onhighlight":""),children:[Object(j.jsx)("g",{className:"background",opacity:.2}),Object(j.jsxs)("g",{className:"drawArea",children:[Object(j.jsx)("g",{className:"links",children:h.map((function(e){var t;return Object(j.jsxs)(k,{className:"outer_node element "+(null!==(t=e._class)&&void 0!==t?t:"")+(e.hide?" hide":"")+(f&&(f.list[e.source.id]||f.list[e.target.id])?" highlight":""),opacity:.7,transform:"scale(1,1)",freezing:n.state.freezing,setfreezing:function(e){n.setState({freezing:e}),e||n.onRelease()},mouseOver:function(t){return n.onMouseOver(e,t)},mouseLeave:function(){return n.onRelease()},children:["source-target"===a?Object(j.jsxs)("linearGradient",{id:e._id,gradientUnits:"userSpaceOnUse",x1:e.source.x1,x2:e.target.x0,children:[Object(j.jsx)("stop",{offset:"0%",stopColor:n.getColorScale(e.source)}),Object(j.jsx)("stop",{offset:"100%",stopColor:n.getColorScale(e.target)})]}):"",Object(j.jsx)("path",{className:"main",fill:n.getColorScale===n._getColorScale_byName?"url(#".concat(e._id,")"):n.getColorScale(e.target),stroke:"url(#".concat(e._id,")"),strokeWidth:.1,d:s(e,n.props.linearScale)})]},e._id)}))}),Object(j.jsx)("g",{className:"nodes",children:u.map((function(e){var t,i,o;return Object(j.jsxs)("g",{className:"outer_node element"+(f&&f.list[e.id]?" highlight":""),transform:"translate(".concat(e.x0,",").concat(e.y0,")"),children:[Object(j.jsx)("text",{x:-6,y:(null!==(t=e.y1+e.y0)&&void 0!==t?t:0)/2-e.y0,dy:"0.35em",textAnchor:"end",paintOrder:"stroke",stroke:"white",strokeWidth:3,fill:"black",children:e.id}),Object(j.jsx)("rect",{height:null!==(i=e.y1-e.y0)&&void 0!==i?i:0,width:null!==(o=e.x1-e.x0)&&void 0!==o?o:0,fill:n._getColorScale_byName(e)})]},e.id)}))})]})]}):""]})})}}]),n}(o.a.Component);function x(e){return[e.source.x1,e.y0]}function S(e){return[e.target.x0,e.y1]}function w(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return i+=o,"M ".concat(e[0]," ").concat(e[1]-i," C ").concat(e[0]+n," ").concat(e[1]-i,", ").concat(t[0]-n," ").concat(t[1]-i,", ").concat(t[0]," ").concat(t[1]-i,"\n            L ").concat(t[0]," ").concat(t[1]+i," C ").concat(t[0]-n," ").concat(t[1]+i,", ").concat(e[0]+n," ").concat(e[1]+i,", ").concat(e[0]," ").concat(e[1]+i," Z")}function C(e){return null!==e&&"object"===typeof e?e.valueOf():e}y.defaultProps={links:[],nodes:[],format:",",nodeId:function(e){return e.id},nodeGroup:null,nodeGroups:null,nodeLabel:null,nodeTitle:function(e,t){return"".concat(t.id,"\n").concat(e(t.value))},nodeAlign:v.b,nodeWidth:15,nodePadding:10,nodeLabelPadding:6,nodeStroke:"currentColor",nodeStrokeWidth:null,nodeStrokeOpacity:null,nodeStrokeLinejoin:null,linkSource:function(e){return e.source},linkTarget:function(e){return e.target},linkValue:function(e){return e.value},linkPath:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=x(e),i=S(e),o=(i[0]-n[0])/2,r=e.width/2;return w(n,i,o,r,t)},linkTitle:function(e,t){return"".concat(t.source.id," \u2192 ").concat(t.target.id,"\n").concat(e(t.value))},linkColor:"source-target",linkStrokeOpacity:.5,linkMixBlendMode:"multiply",colors:g.i,width:640,height:400,marginTop:5,marginRight:1,marginBottom:5,marginLeft:1};var _=Object(f.a)((function(e){return{svg:{"& .fade":{opacity:.2},"& .onhighlight .outer_node:not(.highlight)":{opacity:.1},"& .onhighlight .outer_node.highlight":{opacity:1}}}}))(y),z=n(347),N=n(346),L=n(304),E=n.p+"static/media/EDR-EII.09484611.csv",F=["Category","NFG","Lead","Status"],M=["M BTU/D","TIC","EII Reduction Estimate","CO2 Reduction (Metric Ton/yr)","Savings USD/YR"],D=Object(g.a)(E);function G(e){var t={},n={},i=[];return Object.keys(e[0]).forEach((function(e){return i.push({field:e,headerName:e,width:150})})),e.forEach((function(e,t){var n;Object.keys(e).forEach((function(t){return e[t]=e[t].trim()})),e._value={},r(e,F[0]);for(var i=1;i<F.length;i++)r(e,F[i]),o(e,F[i-1],F[i]);M.forEach((function(t){e._value[t]=+e[t],isNaN(e._value[t])&&(e._value[t]=0)})),e.id=null!==(n=e.id)&&void 0!==n?n:t})),{nodes:Object.values(t),links:Object.values(n),columnsDisplay:i};function o(e,t,i){if(e[t]&&e[i]){var o=e[t]+"_"+e[i];if(!n[o]){var r={source:e[t],target:e[i],element:[]};n[o]=r}n[o].element.push(e)}}function r(e,n){if(e[n]){if(!t[e[n]]){var i={id:e[n],element:[]};t[e[n]]=i}t[e[n]].element.push(e)}}}var T=M,R=n(118);function I(e){var t=e.data,n=e.columns;return Object(j.jsx)("div",{style:{height:300,width:"100%"},children:Object(j.jsx)(R.a,{rows:t,columns:n})})}var P=Object(b.a)((function(e){return{grow:{flexGrow:1}}}));var V=function(){var e=o.a.useState([]),t=Object(s.a)(e,2),n=t[0],r=t[1],a=o.a.useState([]),c=Object(s.a)(a,2),l=c[0],u=c[1],h=o.a.useState([]),d=Object(s.a)(h,2),f=d[0],v=d[1],p=o.a.useState([]),m=Object(s.a)(p,2),b=m[0],O=m[1],k=o.a.useState(T[0]),y=Object(s.a)(k,2),x=y[0];y[1],Object(i.useEffect)((function(){D.then(G).then((function(e){var t=e.nodes,n=e.links,i=e.columnsDisplay;S(t,n),r(t),u(n),v(i)}))}),[D]);var S=function(e,t){return t.forEach((function(e){e.value=Object(g.k)(e.element,(function(e){return e._value[x]}))})),e.forEach((function(e){e.value=Object(g.k)(e.element,(function(e){return e._value[x]}))})),{nodes:e,links:t}};return P(),Object(j.jsxs)("div",{className:"App",children:[Object(j.jsx)(z.a,{position:"static",children:Object(j.jsx)(N.a,{children:Object(j.jsxs)(L.a,{variant:"h6",noWrap:!0,component:"div",sx:{display:{xs:"none",sm:"block"}},children:["EDR-EII sankey by ",x]})})}),Object(j.jsx)("div",{style:{width:"100%"},children:Object(j.jsx)(_,{nodes:n,links:l,width:1200,height:500,mouseOver:function(e){return O(e.element)},mouseLeave:function(){return O([])}})}),Object(j.jsx)(I,{data:b,columns:f})]})},A=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,351)).then((function(t){var n=t.getCLS,i=t.getFID,o=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),i(e),o(e),r(e),a(e)}))};a.a.render(Object(j.jsx)(o.a.StrictMode,{children:Object(j.jsx)(V,{})}),document.getElementById("root")),A()}},[[296,1,2]]]);
//# sourceMappingURL=main.c4d422cf.chunk.js.map